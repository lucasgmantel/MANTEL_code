# Python Project : Solvent-Accessibility Surface Area of a protein
**Lucas Mantel, M2 Biologie-Informatique, Université Paris Cité, Paris, France**

---
### Project Presentation 

This project implements a Python script (`sasa.py`) to calculate the Solvent-Accessible Surface Area (SASA) and the Relative Solvent Accessibility (RSA) per residue of a given protein. SASA and RSA are key metrics in structural biology, as they help analyze protein folding and solvent exposure. Thus, my project provides a reproducible program to compute these metrics and compare them with a reference tool (FreeSASA). The method is based on Shrake and Rupley’s algorithm, which uses 92 uniformly distributed points on a sphere to model the atomic surface.

**Key Features :**
- Computes SASA and RSA for each residue in a PDB file
- Uses a sphere of 92 points (Saff & Kuijlaars) for surface modeling
- Compares results with those computed by FreeSASA
- Saves a per-residue comparison plot in the `./results` directory

The 92 points of the sphere were generated by the `sph_saff.py` script. This script generates the 92 points using the Saff & Kuijlaars algorithm and writes their (x, y, z) coordinates in the `sphere.txt` file. The `anti_lib.py` script is necessary for the `sph_saff.py` script to run. These scripts were used independently from my main script. The `sasa.py` script extracts the points coordinates from the `sphere.txt` file to generate the spheres modeling the atoms.

The `sasa.py` script was run on 3 protein structures to evaluate its performance : the lysozyme (PDB code : 1AKI), the barstar (PDB code : 1BTA) and the insulin (PDB code : 3I40). The barplots generated for each structure were saved in the `./results` directory so you can have a look at the results.

---
### Directory Organization

The working directory is organized as follows :

```bash
MANTEL_code/
│
├── .gitattributes           # Ensures consistent handling of line endings across different operating systems
├── .gitignore               # Specifies files and directories to be ignored by Git
├── data/                    # PDB files of the example structures
│   ├── 1AKI.pdb                 # 1AKI (lysozyme)
│   ├── 1BTA.pdb                 # 1BTA (barstar)
│   └── 3I40.pdb                 # 3I40 (insulin)
├── pixi.lock                # Locks exact versions of dependencies for reproducibility
├── pixi.toml                # Configuration file for the Pixi package, contains the dependencies of the project
├── README.md                # The current document, describes the project and its directory
├── results/                 # Barplots generated by the program
│   ├── 1AKI_rsa.png             # Results for the 1AKI PDB structure
│   ├── 1BTA_rsa.png             # Results for the 1BTA PDB structure
│   └── 3I40_rsa.png             # Results for the 3I40 PDB structure
└── src/                     # Programs
    ├── anti_lib.py              # Script necessary to run sph_saff.py
    ├── sasa.py                  # The implemented program, computes the SASA and RSA of a given protein structure
    ├── sph_saff.py              # Generates 92 uniformly distributed points of a sphere (Saff & Kuijlaars algorithm)
    └── sphere.txt               # The (x, y, z) coordinates of the points of the sphere generated by sph_saff.py
```

**Legend:**
- `.pdb`: Protein Data Bank files (3D structures of proteins).
- `.png`: Generated bar plots comparing RSA values.
- `.py`: Python scripts.

---
### Requirements

The project requires Python 3.10+ and the following libraries:
- Biopython
- NumPy
- Matplotlib
- FreeSASA (for comparison)
The libraries can be installed using the Pixi package manager with the provided `pixi.toml` configuration file. You can install Pixi by following the instructions on the [Pixi installation page](https://pixi.sh/latest/#installation). To install the dependencies, move to the project directory (`MANTEL_code`) and run the following command :

```bash
pixi install
```

The exact versions of the dependencies used in this project are locked in the `pixi.lock` file to ensure reproducibility. You can also install the dependencies using another package manager like pip or conda, but make sure to use compatible versions.

The 92 points of the sphere were generated using the `sph_saff.py` script, which implements the Saff & Kuijlaars algorithm to distribute points uniformly on a unit sphere. The coordinates are saved in `sphere.txt` and used by `sasa.py` to model atomic surfaces. The `anti_lib.py` script is a dependency for `sph_saff.py` (part of the [antiprism-python package](https://pypi.org/project/antiprism-python/)).

---
### Script Usage

The main script `sasa.py` can be run from the command line. It takes a PDB file as input and computes the SASA and RSA for each residue in the structure. The results are compared with those computed by FreeSASA, and a bar plot is generated to visualize the RSA values per residue. To run the script, move to the `MANTEL_code/src` directory and use one of the following commands :

```bash
# Using Pixi
pixi run python sasa.py <path_to_pdb_file>
# Using Python directly (conda or pip environment)
python sasa.py <path_to_pdb_file>
```

In my case, the example PDB files are located in the `MANTEL_code/data` directory. For example, to run the script on the lysozyme structure (1AKI), you would use one of the following commands :

```bash
# Using Pixi
pixi run python sasa.py ../data/1AKI.pdb
# Using Python directly (conda or pip environment)
python sasa.py ../data/1AKI.pdb
```

It is important to make sure the `sphere.txt` file must be in the same directory as the `sasa.py` script for it to run properly. In my case, both files are located in the `MANTEL_code/src` directory. The generated bar plot will be saved in the `MANTEL_code/results` directory with a filename corresponding to the input PDB file (e.g., `1AKI_rsa.png` for the lysozyme structure).

---
### Example output

```bash
$ pixi run python sasa.py ../data/1AKI.pdb

###  Computing total Solvent-Accessible Surface Area (SASA) using the implemented algorithm...  ###

     Total SASA : 6530.5 Å²

###  Computing total Solvent-Accessible Surface Area (SASA) using FreeSASA...  ###

     Total SASA : 6520.8 Å²

###  Computing Relative Solvent Accessibility (RSA)...  ###

     RSA Figure saved at ../results/1AKI_rsa.png

###  Computation run successfully !  ###
```

---
### Acknowledgements

This project was developed as part of the Biologie-Informatique Master's Degree program at Université Paris Cité, Paris, France. I would like to thank my instructors for their guidance and support throughout the project.

- [Biopython](https://biopython.org/) for PDB parsing and structure manipulation.
- [FreeSASA](https://freesasa.github.io/python/) for SASA comparison.
- [Antiprism](https://pypi.org/project/antiprism-python/) for sphere point generation.

---